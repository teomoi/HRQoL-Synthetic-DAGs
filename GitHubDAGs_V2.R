rm(list=ls())

install.packages("bnlearn")
library(bnlearn)

#########
# DAG1.1.
lv = c("1", "2", "3", "4")
cptA = array(c(0.5, 0.2,0.1,0.2), dim = 4, dimnames = list(A = lv));cptA

cptB = array(c(0.1, 0.2,0.1,0.6), dim = 4, dimnames = list(B = lv));cptB

cptC = array(c(0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.3,0.3,0.2,  
               0.75,0.2,0.05,0.0,  0.8,0.1,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.6,0.15,0.05,  0.1,0.4,0.3,0.2,  0.0,0.2,0.7,0.1,  0.0,0.2,0.4,0.4,  
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.4,0.5,  0.0,0.0,0.1,0.9), 
             dim = c(4, 4, 4),
             dimnames = list(C = lv, A = lv, B = lv) ); cptC

cptD = array(c(0.7,0.2,0.1,0.0,  0.8,0.1,0.1,0.0,  0.2,0.3,0.4,0.1,  0.0,0.0,0.9,0.1), 
             dim = c(4,4), dimnames = list(D = lv, B = lv)); cptD

cptE = array(c(0.7,0.2,0.1,0.0,  0.65,0.25,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.5,0.3,0.2,0.0,  0.75,0.15,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.2,0.1,  0.1,0.35,0.35,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.3,0.5,  
               0.1,0.4,0.4,0.1,  0.1,0.0,0.75,0.15,  0.0,0.1,0.5,0.4,  0.0,0.0,0.3,0.7), 
             dim = c(4, 4, 4),
             dimnames = list(E = lv, A = lv, B = lv) ); cptE

cptH = array(c(0.9,0.1,0.0,0.0,  0.8,0.1,0.1,0.0,  0.1,0.5,0.3,0.1,  0.0,0.0,0.1,0.9), 
             dim = c(4,4), dimnames = list(H = lv, D = lv)); cptH

cptF = array(c(0.1, 0.8,0.05,0.05), dim = 4, dimnames = list(F = lv)); cptF

cptG = array(c(0.1, 0.2,0.35,0.35), dim = 4, dimnames = list(G = lv)); cptG

cptI = array(c(0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.65,0.3,0.05,0.0,  0.8,0.1,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,  
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.5,0.4,  0.0,0.0,0.1,0.9), 
             dim = c(4,4,4), dimnames = list(I = lv, F = lv, H = lv)); cptI

cptJ = array(c(0.25, 0.35,0.15,0.25), dim = 4, dimnames = list(J = lv)); cptJ

cptK = array(c(0.9,0.1,0.0,0.0,  0.8,0.1,0.1,0.0,  0.6,0.3,0.05,0.05,  0.4,0.3,0.2,0.1,  
               0.85,0.1,0.05,0.0,  0.7,0.15,0.15,0.0,  0.4,0.4,0.15,0.05,  0.3,0.3,0.2,0.2,
               0.45,0.45,0.1,0.0,  0.4,0.4,0.1,0.1,  0.2,0.6,0.1,0.1,  0.1,0.2,0.4,0.3,  
               0.4,0.4,0.1,0.1,   0.35,0.5,0.1,0.05,  0.2,0.3,0.3,0.2,  0.15,0.2,0.3,0.35,
               0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.35,0.5,0.1,0.05,  0.1,0.8,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,  
               0.1,0.4,0.4,0.1,  0.1,0.35,0.3,0.25,  0.0,0.1,0.5,0.4,  0.0,0.1,0.7,0.2,
               0.5,0.3,0.2,0.0,  0.3,0.6,0.1,0.0,  0.2,0.2,0.5,0.1,  0.15,0.2,0.4,0.25,  
               0.3,0.4,0.2,0.1,  0.2,0.55,0.25,0.0,  0.2,0.15,0.55,0.1,  0.1,0.3,0.4,0.2,
               0.15,0.15,0.6,0.1,  0.1,0.3,0.5,0.1,  0.0,0.2,0.75,0.05,  0.0,0.2,0.6,0.2,  
               0.2,0.1,0.4,0.3,   0.05,0.2,0.4,0.35,  0.1,0.1,0.7,0.1,  0.05,0.1,0.3,0.55,
               0.5,0.2,0.1,0.2,  0.3,0.3,0.1,0.3,  0.2,0.1,0.4,0.3,  0.2,0.1,0.2,0.5,  
               0.25,0.25,0.1,0.4,  0.1,0.5,0.2,0.2,  0.1,0.3,0.4,0.2,  0.0,0.3,0.2,0.5,
               0.2,0.15,0.35,0.3,  0.1,0.4,0.3,0.2,  0.0,0.2,0.6,0.2,  0.0,0.2,0.2,0.6,  
               0.2,0.0,0.15,0.65,  0.1,0.25,0.2,0.45,  0.0,0.1,0.3,0.6,  0.0,0.1,0.1,0.8), 
             dim = c(4,4,4,4), dimnames = list(K = lv, F = lv, G = lv, H = lv)); cptK

apply(cptK,2,sum)

Score.coef = matrix(c(2, 2.50, 3, 5.5, 
                      3, 3.50, 4, 7,
                      4.5, 5, 6, 8.75, 
                      7, 7.50, 7.5, 10,
                      7, 7.50, 9, 10.5, 
                      5, 5.50, 6, 9,
                      7.5, 8, 9.5, 10.75, 
                      10, 10.50, 11.5, 14,
                      5, 5.50, 6, 10.5, 
                      6, 6.50, 7, 11,
                      7.5, 8, 9, 12.75, 
                      11, 11.50, 12.5, 15,
                      8, 8.50, 8, 9.5, 
                      9, 10.50, 10, 11,
                      10, 12, 12, 16.75, 
                      10, 14.50, 16.5, 18), nrow = 1, ncol = 64,
                    dimnames = list("(Intercept)", NULL));Score.coef
Score.dist = list(coef = Score.coef, sd = c(0.3, 0.4, 1, 0.31,
                                            0.58, 0.647, 0.2, 0.31,
                                            0.88, 0.87, 1, 0.31,
                                            0.9, 0.95, 0.2, 0.5,
                                            0.5, 0.4, 1, 0.31,
                                            0.68, 0.7, 1.2, 0.31,
                                            1.0, 0.9, 2, 1.31,
                                            0.4, 1.5, 2.2, 1.5,
                                            0.7, 1.4, 2, 1.31,
                                            0.58, 0.647, 2.2, 1.31,
                                            0.88, 0.87, 2, 1.31,
                                            0.9, 0.95, 2.2, 1.5,
                                            1.3, 1.4, 2, 1.31,
                                            1.0, 1.147, 3.2, 1.31,
                                            1.08, 1.27, 1, 1.31,
                                            0.9, 1.25, 1.2, 0.5));Score.dist

net1.1 = model2network("[A][B][C|A:B][D|B][E|A:B][F][G][H|D][I|F:H][J][K|F:G:H][Score|E:C:D]")
par(mfrow=c(1,1))
graphviz.plot(net1.1)

cpt = list(A = cptA, B = cptB, C = cptC, D = cptD, E = cptE, F = cptF, G = cptG,
           H = cptH, I = cptI, J = cptJ, K = cptK, Score=Score.dist)
DAG1.1 = custom.fit(net1.1, cpt, ordinal = c("A", "B", "C", "D", "E", "F", "G", "H",
                                                  "I", "J", "K"))
################################################################################

#########
# DAG1.2.
lv = c("1", "2", "3", "4")
cptA = array(c(0.2, 0.1,0.2,0.5), dim = 4, dimnames = list(A = lv));cptA

cptB = array(c(0.1, 0.2,0.1,0.6), dim = 4, dimnames = list(B = lv));cptB

cptC = array(c(0.2,0.2,0.4,0.2,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.3,0.3,0.2,  
               0.55,0.4,0.05,0.0,  0.6,0.3,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.4,0.35,0.05,  0.1,0.3,0.4,0.2,  0.0,0.2,0.7,0.1,  0.0,0.2,0.4,0.4,  
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.4,0.5,  0.0,0.0,0.2,0.8), 
             dim = c(4, 4, 4),
             dimnames = list(C = lv, A = lv, B = lv) ); cptC

cptD = array(c(0.2,0.2,0.5,0.1,  0.6,0.1,0.3,0.0,  0.2,0.3,0.4,0.1,  0.0,0.0,0.9,0.1), 
             dim = c(4,4), dimnames = list(D = lv, C = lv)); cptD

cptE = array(c(0.7,0.2,0.1,0.0,  0.65,0.25,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.5,0.3,0.2,0.0,  0.75,0.15,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.2,0.1,  0.1,0.35,0.35,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.3,0.5,  
               0.1,0.4,0.4,0.1,  0.1,0.0,0.75,0.15,  0.0,0.1,0.5,0.4,  0.0,0.0,0.3,0.7), 
             dim = c(4, 4, 4),
             dimnames = list(E = lv, C = lv, D = lv) ); cptE

cptF = array(c(0.1, 0.4,0.25,0.25), dim = 4, dimnames = list(F = lv)); cptF

cptG = array(c(0.3, 0.0,0.35,0.35), dim = 4, dimnames = list(G = lv)); cptG

cptH = array(c(0.3,0.1,0.3,0.3,  0.4,0.1,0.1,0.4,  0.1,0.5,0.3,0.1,  0.2,0.2,0.1,0.5), 
             dim = c(4,4), dimnames = list(H = lv, A = lv)); cptH

cptI = array(c(0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.65,0.3,0.05,0.0,  0.8,0.1,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,  
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.5,0.4,  0.0,0.0,0.1,0.9), 
             dim = c(4,4,4), dimnames = list(I = lv, F = lv, G = lv)); cptI

cptJ = array(c(0.25, 0.25,0.15,0.35), dim = 4, dimnames = list(J = lv)); cptJ

cptK = array(c(0.3,0.6,0.1,0.0,  0.5,0.4,0.1,0.0,  0.1,0.5,0.3,0.1,  0.0,0.0,0.1,0.9), 
             dim = c(4,4), dimnames = list(K = lv, J = lv)); cptK

apply(cptK,2,sum)

Score.coef = matrix(c(2, 2.50, 3, 5.5, 
                      3, 3.50, 4, 7,
                      4.5, 5, 6, 8.75, 
                      7, 7.50, 7.5, 10,
                      7, 7.50, 9, 10.5, 
                      5, 5.50, 6, 9,
                      7.5, 8, 9.5, 10.75, 
                      10, 10.50, 11.5, 14,
                      5, 5.50, 6, 10.5, 
                      6, 6.50, 7, 11,
                      7.5, 8, 9, 12.75, 
                      11, 11.50, 12.5, 15,
                      8, 8.50, 8, 9.5, 
                      9, 10.50, 10, 11,
                      10, 12, 12, 16.75, 
                      10, 14.50, 16.5, 18), nrow = 1, ncol = 64,
                    dimnames = list("(Intercept)", NULL));Score.coef
Score.dist = list(coef = Score.coef, sd = c(0.3, 0.4, 1, 0.31,
                                            0.58, 0.647, 0.2, 0.31,
                                            0.88, 0.87, 1, 0.31,
                                            0.9, 0.95, 0.2, 0.5,
                                            0.5, 0.4, 1, 0.31,
                                            0.68, 0.7, 1.2, 0.31,
                                            1.0, 0.9, 2, 1.31,
                                            0.4, 1.5, 2.2, 1.5,
                                            0.7, 1.4, 2, 1.31,
                                            0.58, 0.647, 2.2, 1.31,
                                            0.88, 0.87, 2, 1.31,
                                            0.9, 0.95, 2.2, 1.5,
                                            1.3, 1.4, 2, 1.31,
                                            1.0, 1.147, 3.2, 1.31,
                                            1.08, 1.27, 1, 1.31,
                                            0.9, 1.25, 1.2, 0.5));Score.dist

net1.2 = model2network("[A][B][C|A:B][D|C][E|C:D][F][G][H|A][I|F:G][J][K|J][Score|H:I:K]")
par(mfrow=c(1,1))
graphviz.plot(net1.2)

cpt = list(A = cptA, B = cptB, C = cptC, D = cptD, E = cptE, F = cptF, G = cptG,
           H = cptH, I = cptI, J = cptJ, K = cptK, Score=Score.dist)
DAG1.2 = custom.fit(net1.2, cpt, ordinal = c("A", "B", "C", "D", "E", "F", "G", "H",
                                                    "I", "J", "K"))
################################################################################

#########
# DAG2.1.
lv = c("1", "2", "3", "4")
cptA = array(c(0.5, 0.2,0.1,0.2), dim = 4, dimnames = list(A = lv));cptA

cptB = array(c(0.1, 0.2,0.1,0.6), dim = 4, dimnames = list(B = lv));cptB

cptC = array(c(0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.3,0.3,0.2,  
               0.75,0.2,0.05,0.0,  0.8,0.1,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.6,0.15,0.05,  0.1,0.4,0.3,0.2,  0.0,0.2,0.7,0.1,  0.0,0.2,0.4,0.4,  
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.4,0.5,  0.0,0.0,0.1,0.9), 
             dim = c(4, 4, 4),
             dimnames = list(C = lv, A = lv, B = lv) ); cptC

cptE = array(c(0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.65,0.3,0.05,0.0,  0.8,0.1,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.35,0.45,  
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.5,0.4,  0.0,0.0,0.15,0.85), 
             dim = c(4, 4, 4),
             dimnames = list(E = lv, A = lv, B = lv) ); cptE

cptF = array(c(0.1, 0.3,0.35,0.25), dim = 4, dimnames = list(F = lv)); cptF

cptG = array(c(0.1, 0.2,0.25,0.45), dim = 4, dimnames = list(G = lv)); cptG

cptD = array(c(0.7,0.2,0.1,0.0,  0.65,0.25,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.55,0.35,0.1,0.0,  0.75,0.15,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.1,0.1,0.8,  
               0.1,0.4,0.4,0.1,  0.1,0.0,0.85,0.05,  0.0,0.1,0.5,0.4,  0.0,0.0,0.05,0.95), 
             dim = c(4, 4, 4),
             dimnames = list(D = lv, F = lv, G = lv) ); cptD

cptH = array(c(0.9,0.1,0.0,0.0,  0.8,0.1,0.1,0.0,  0.1,0.5,0.3,0.1,  0.0,0.0,0.1,0.9), 
             dim = c(4,4), dimnames = list(H = lv, J = lv)); cptH

cptI = array(c(0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.65,0.3,0.05,0.0,  0.8,0.1,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,  
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.5,0.4,  0.0,0.0,0.1,0.9), 
             dim = c(4,4,4), dimnames = list(I = lv, F = lv, H = lv)); cptI

cptJ = array(c(0.25, 0.35,0.15,0.25), dim = 4, dimnames = list(J = lv)); cptJ

cptK = array(c(0.3,0.6,0.1,0.0,  0.5,0.4,0.1,0.0,  0.1,0.5,0.3,0.1,  0.0,0.0,0.1,0.9), 
             dim = c(4,4), dimnames = list(K = lv, G = lv)); cptK

cptL = array(c(0.25, 0.45,0.15,0.15), dim = 4, dimnames = list(L = lv)); cptL

cptM = array(c(0.15, 0.25,0.35,0.25), dim = 4, dimnames = list(M = lv)); cptM

cptN = array(c(0.9,0.1,0,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.85,0.1,0.05,0.0,  0.8,0.1,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,  
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.4,0.5,  0.0,0.0,0.1,0.9), 
             dim = c(4,4,4), dimnames = list(N = lv, L = lv, M = lv)); cptN

cptO = array(c(0.8,0.15,0.05,0.0,  0.1,0.9,0.0,0.0,  0.1,0.2,0.6,0.1,  0.0,0.0,0.1,0.9), 
             dim = c(4,4), dimnames = list(O = lv, F = lv)); cptO

Score.coef = matrix(c(2, 2.50, 3, 5.5, 
                      3, 3.50, 4, 7,
                      4.5, 5, 6, 8.75, 
                      7, 7.50, 7.5, 10,
                      7, 7.50, 9, 10.5, 
                      5, 5.50, 6, 9,
                      7.5, 8, 9.5, 10.75, 
                      10, 10.50, 11.5, 14,
                      5, 5.50, 6, 10.5, 
                      6, 6.50, 7, 11,
                      7.5, 8, 9, 12.75, 
                      11, 11.50, 12.5, 15,
                      8, 8.50, 8, 9.5, 
                      9, 10.50, 10, 11,
                      10, 12, 12, 16.75, 
                      10, 14.50, 16.5, 18), nrow = 1, ncol = 64,
                    dimnames = list("(Intercept)", NULL));Score.coef
Score.dist = list(coef = Score.coef, sd = c(0.3, 0.4, 1, 0.31,
                                            0.58, 0.647, 0.2, 0.31,
                                            0.88, 0.87, 1, 0.31,
                                            0.9, 0.95, 0.2, 0.5,
                                            0.5, 0.4, 1, 0.31,
                                            0.68, 0.7, 1.2, 0.31,
                                            1.0, 0.9, 2, 1.31,
                                            0.4, 1.5, 2.2, 1.5,
                                            0.7, 1.4, 2, 1.31,
                                            0.58, 0.647, 2.2, 1.31,
                                            0.88, 0.87, 2, 1.31,
                                            0.9, 0.95, 2.2, 1.5,
                                            1.3, 1.4, 2, 1.31,
                                            1.0, 1.147, 3.2, 1.31,
                                            1.08, 1.27, 1, 1.31,
                                            0.9, 1.25, 1.2, 0.5));Score.dist

net2.1 = model2network("[A][B][C|A:B][Score|A:D:J][E|A:B][F][G][D|F:G][H|J][I|F:H][J][K|G][L][M][N|L:M][O|F]")

par(mfrow=c(1,1))
graphviz.plot(net2.1)

cpt = list(A = cptA, B = cptB, C = cptC, D = cptD, E = cptE, 
           F = cptF, G = cptG, H = cptH, I = cptI, J = cptJ,
           K = cptK, L = cptL, M = cptM, N = cptN, O = cptO,
           Score=Score.dist)

DAG2.1 = custom.fit(net2.1, cpt, ordinal = c("A", "B", "C", "D", "E", "F", "G", "H",
                                        "I", "J", "K", "L", "M", "N", "O"))
################################################################################

#########
# DAG2.2.
lv = c("1", "2", "3", "4")
cptO = array(c(0.9,0.1,0.0,0.0,  0.8,0.1,0.1,0.0,  0.1,0.5,0.3,0.1,  0.0,0.0,0.1,0.9), 
             dim = c(4,4), dimnames = list(O = lv, N = lv)); cptO

cptN = array(c(0.2, 0.3,0.4,0.1), dim = 4, dimnames = list(N = lv));cptN

cptM = array(c(0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.3,0.3,0.2,  
               0.75,0.2,0.05,0.0,  0.8,0.1,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.6,0.15,0.05,  0.1,0.4,0.3,0.2,  0.0,0.2,0.7,0.1,  0.0,0.2,0.4,0.4,  
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.4,0.5,  0.0,0.0,0.1,0.9), 
             dim = c(4, 4, 4),
             dimnames = list(M = lv, I = lv, J = lv) ); cptM

cptL = array(c(0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.65,0.3,0.05,0.0,  0.8,0.1,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.35,0.45,  
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.5,0.4,  0.0,0.0,0.15,0.85), 
             dim = c(4, 4, 4),
             dimnames = list(L = lv, I = lv, J = lv) ); cptL

cptK = array(c(0.1, 0.3,0.35,0.25), dim = 4, dimnames = list(K = lv)); cptK

cptJ = array(c(0.1, 0.2,0.25,0.45), dim = 4, dimnames = list(J = lv)); cptJ

cptI = array(c(0.7,0.2,0.1,0.0,  0.65,0.25,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.55,0.35,0.1,0.0,  0.75,0.15,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.1,0.1,0.8,  
               0.1,0.4,0.4,0.1,  0.1,0.0,0.85,0.05,  0.0,0.1,0.5,0.4,  0.0,0.0,0.05,0.95), 
             dim = c(4, 4, 4),
             dimnames = list(I = lv, F = lv, G = lv) ); cptI

cptH = array(c(0.9,0.1,0.0,0.0,  0.8,0.1,0.1,0.0,  0.1,0.5,0.3,0.1,  0.0,0.0,0.1,0.9), 
             dim = c(4,4), dimnames = list(H = lv, A = lv)); cptH

cptG = array(c(0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.65,0.3,0.05,0.0,  0.8,0.1,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,  
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.5,0.4,  0.0,0.0,0.1,0.9), 
             dim = c(4,4,4), dimnames = list(G = lv, F = lv, E = lv)); cptG

cptF = array(c(0.25, 0.35,0.15,0.25), dim = 4, dimnames = list(F = lv)); cptF

cptE = array(c(0.9,0.1,0.0,0.0,  0.8,0.1,0.1,0.0,  0.6,0.3,0.05,0.05,  0.4,0.3,0.2,0.1,
               0.85,0.1,0.05,0.0,  0.7,0.15,0.15,0.0,  0.4,0.4,0.15,0.05,  0.3,0.3,0.2,0.2,
               0.45,0.45,0.1,0.0,  0.4,0.4,0.1,0.1,  0.2,0.6,0.1,0.1,  0.1,0.2,0.4,0.3,
               0.4,0.4,0.1,0.1,   0.35,0.5,0.1,0.05,  0.2,0.3,0.3,0.2,  0.15,0.2,0.3,0.35,
               0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,
               0.35,0.5,0.1,0.05,  0.1,0.8,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,
               0.1,0.4,0.4,0.1,  0.1,0.35,0.3,0.25,  0.0,0.1,0.5,0.4,  0.0,0.1,0.7,0.2,
               0.5,0.3,0.2,0.0,  0.3,0.6,0.1,0.0,  0.2,0.2,0.5,0.1,  0.15,0.2,0.4,0.25,
               0.3,0.4,0.2,0.1,  0.2,0.55,0.25,0.0,  0.2,0.15,0.55,0.1,  0.1,0.3,0.4,0.2,
               0.15,0.15,0.6,0.1,  0.1,0.3,0.5,0.1,  0.0,0.2,0.75,0.05,  0.0,0.2,0.6,0.2,
               0.2,0.1,0.4,0.3,   0.05,0.2,0.4,0.35,  0.1,0.1,0.7,0.1,  0.05,0.1,0.3,0.55,
               0.5,0.2,0.1,0.2,  0.3,0.3,0.1,0.3,  0.2,0.1,0.4,0.3,  0.2,0.1,0.2,0.5,
               0.25,0.25,0.1,0.4,  0.1,0.5,0.2,0.2,  0.1,0.3,0.4,0.2,  0.0,0.3,0.2,0.5,
               0.2,0.15,0.35,0.3,  0.1,0.4,0.3,0.2,  0.0,0.2,0.6,0.2,  0.0,0.2,0.2,0.6,
               0.2,0.0,0.15,0.65,  0.1,0.25,0.2,0.45,  0.0,0.1,0.3,0.6,  0.0,0.1,0.1,0.8),
             dim = c(4,4,4,4), dimnames = list(E = lv, A = lv, B = lv, C = lv)); cptE

cptD = array(c(0.9,0.1,0,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.85,0.1,0.05,0.0,  0.8,0.1,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,  
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.4,0.5,  0.0,0.0,0.1,0.9), 
             dim = c(4,4,4), dimnames = list(D = lv, A = lv, C = lv)); cptD

cptC = array(c(0.15, 0.25,0.35,0.25), dim = 4, dimnames = list(C = lv)); cptC

cptB = array(c(0.8,0.15,0.05,0.0,  0.1,0.9,0.0,0.0,  0.1,0.2,0.6,0.1,  0.0,0.0,0.1,0.9), 
             dim = c(4,4), dimnames = list(B = lv, A = lv)); cptA

cptA = array(c(0.25, 0.45,0.15,0.15), dim = 4, dimnames = list(A = lv)); cptA

Score.coef = matrix(c(2, 2.50, 3, 5.5, 
                      3, 3.50, 4, 7,
                      4.5, 5, 6, 8.75, 
                      7, 7.50, 7.5, 10,
                      7, 7.50, 9, 10.5, 
                      5, 5.50, 6, 9,
                      7.5, 8, 9.5, 10.75, 
                      10, 10.50, 11.5, 14,
                      5, 5.50, 6, 10.5, 
                      6, 6.50, 7, 11,
                      7.5, 8, 9, 12.75, 
                      11, 11.50, 12.5, 15,
                      8, 8.50, 8, 9.5, 
                      9, 10.50, 10, 11,
                      10, 12, 12, 16.75, 
                      10, 14.50, 16.5, 18), nrow = 1, ncol = 64,
                    dimnames = list("(Intercept)", NULL));Score.coef
Score.dist = list(coef = Score.coef, sd = c(0.3, 0.4, 1, 0.31,
                                            0.58, 0.647, 0.2, 0.31,
                                            0.88, 0.87, 1, 0.31,
                                            0.9, 0.95, 0.2, 0.5,
                                            0.5, 0.4, 1, 0.31,
                                            0.68, 0.7, 1.2, 0.31,
                                            1.0, 0.9, 2, 1.31,
                                            0.4, 1.5, 2.2, 1.5,
                                            0.7, 1.4, 2, 1.31,
                                            0.58, 0.647, 2.2, 1.31,
                                            0.88, 0.87, 2, 1.31,
                                            0.9, 0.95, 2.2, 1.5,
                                            1.3, 1.4, 2, 1.31,
                                            1.0, 1.147, 3.2, 1.31,
                                            1.08, 1.27, 1, 1.31,
                                            0.9, 1.25, 1.2, 0.5));Score.dist

net2.2 = model2network("[A][B|A][C][D|A:C][E|A:B:C][F][G|F:E][H|A][I|F:G][J][K][L|I:J][M|I:J][N][O|N][Score|L:M:N]")

par(mfrow=c(1,1))
graphviz.plot(net2.2)

cpt = list(A = cptA, B = cptB, C = cptC, D = cptD, E = cptE, 
           F = cptF, G = cptG, H = cptH, I = cptI, J = cptJ,
           K = cptK, L = cptL, M = cptM, N = cptN, O = cptO,
           Score=Score.dist)

DAG2.2 = custom.fit(net2.2, cpt, ordinal = c("A", "B", "C", "D", "E", "F", "G", "H",
                                          "I", "J", "K", "L", "M", "N", "O"))
################################################################################

#########
# DAG3.1.
lv = c("1", "2", "3", "4")
cptA = array(c(0.5, 0.2,0.1,0.2), dim = 4, dimnames = list(A = lv));cptA

cptB = array(c(0.1, 0.2,0.1,0.6), dim = 4, dimnames = list(B = lv));cptB

cptC = array(c(0.9,0.1,0.0,0.0,  0.2,0.8,0.0,0.0,  0.0,0.1,0.8,0.1,  0.0,0.0,0.1,0.9), 
             dim = c(4,4), dimnames = list(C = lv, A = lv) ); cptC

cptD = array(c(0.7,0.2,0.1,0.0,  0.4,0.5,0.1,0.0,  0.1,0.3,0.5,0.1,  0.0,0.0,0.4,0.6), 
             dim = c(4,4), dimnames = list(D = lv, B = lv)); cptD

cptE = array(c(0.7,0.2,0.1,0.0,  0.65,0.25,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.5,0.3,0.2,0.0,  0.75,0.15,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.2,0.1,  0.1,0.35,0.35,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.3,0.5,  
               0.1,0.4,0.4,0.1,  0.1,0.0,0.75,0.15,  0.0,0.1,0.5,0.4,  0.0,0.0,0.3,0.7), 
             dim = c(4, 4, 4),
             dimnames = list(E = lv, A = lv, B = lv) ); cptE

cptF = array(c(0.1, 0.8,0.05,0.05), dim = 4, dimnames = list(F = lv)); cptF

cptG = array(c(0.9,0.05,0.05,0.0,  0.8,0.1,0.1,0.0,  0.2,0.3,0.4,0.1,  0.0,0.0,0.05,0.95), 
             dim = c(4,4), dimnames = list(G = lv, N = lv)); cptG

cptH = array(c(0.9,0.1,0.0,0.0,  0.8,0.1,0.1,0.0,  0.1,0.5,0.3,0.1,  0.0,0.0,0.1,0.9), 
             dim = c(4,4), dimnames = list(H = lv, D = lv)); cptH

cptI = array(c(0.9,0.1,0.0,0.0,  0.3,0.6,0.1,0.0,  0.1,0.05,0.75,0.1,  0.0,0.0,0.1,0.9), 
             dim = c(4,4), dimnames = list(I = lv, F = lv)); cptI

cptJ = array(c(0.25, 0.35,0.15,0.25), dim = 4, dimnames = list(J = lv)); cptJ

cptK = array(c(0.9,0.1,0.0,0.0,  0.8,0.1,0.1,0.0,  0.6,0.3,0.05,0.05,  0.4,0.3,0.2,0.1,  
               0.85,0.1,0.05,0.0,  0.7,0.15,0.15,0.0,  0.4,0.4,0.15,0.05,  0.3,0.3,0.2,0.2,
               0.45,0.45,0.1,0.0,  0.4,0.4,0.1,0.1,  0.2,0.6,0.1,0.1,  0.1,0.2,0.4,0.3,  
               0.4,0.4,0.1,0.1,   0.35,0.5,0.1,0.05,  0.2,0.3,0.3,0.2,  0.15,0.2,0.3,0.35,
               0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.35,0.5,0.1,0.05,  0.1,0.8,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,  
               0.1,0.4,0.4,0.1,  0.1,0.35,0.3,0.25,  0.0,0.1,0.5,0.4,  0.0,0.1,0.7,0.2,
               0.5,0.3,0.2,0.0,  0.3,0.6,0.1,0.0,  0.2,0.2,0.5,0.1,  0.15,0.2,0.4,0.25,  
               0.3,0.4,0.2,0.1,  0.2,0.55,0.25,0.0,  0.2,0.15,0.55,0.1,  0.1,0.3,0.4,0.2,
               0.15,0.15,0.6,0.1,  0.1,0.3,0.5,0.1,  0.0,0.2,0.75,0.05,  0.0,0.2,0.6,0.2,  
               0.2,0.1,0.4,0.3,   0.05,0.2,0.4,0.35,  0.1,0.1,0.7,0.1,  0.05,0.1,0.3,0.55,
               0.5,0.2,0.1,0.2,  0.3,0.3,0.1,0.3,  0.2,0.1,0.4,0.3,  0.2,0.1,0.2,0.5,  
               0.25,0.25,0.1,0.4,  0.1,0.5,0.2,0.2,  0.1,0.3,0.4,0.2,  0.0,0.3,0.2,0.5,
               0.2,0.15,0.35,0.3,  0.1,0.4,0.3,0.2,  0.0,0.2,0.6,0.2,  0.0,0.2,0.2,0.6,  
               0.2,0.0,0.15,0.65,  0.1,0.25,0.2,0.45,  0.0,0.1,0.3,0.6,  0.0,0.1,0.1,0.8), 
             dim = c(4,4,4,4), dimnames = list(K = lv, F = lv, G = lv, H = lv)); cptK

cptL = array(c(0.25, 0.45,0.15,0.15), dim = 4, dimnames = list(L = lv)); cptL

cptM = array(c(0.15, 0.25,0.35,0.25), dim = 4, dimnames = list(M = lv)); cptM

cptN = array(c(0.8,0.2,0.0,0.0,  0.3,0.7,0.0,0.0,  0.1,0.3,0.5,0.1,  0.0,0.0,0.1,0.9), 
             dim = c(4,4), dimnames = list(N = lv, A = lv)); cptN

cptO = array(c(0.95,0.05,0.0,0.0,  0.8,0.1,0.1,0.0,  0.6,0.3,0.05,0.05,  0.4,0.3,0.2,0.1,  
               0.9,0.1,0.0,0.0,  0.7,0.15,0.15,0.0,  0.4,0.4,0.15,0.05,  0.3,0.3,0.2,0.2,
               0.55,0.35,0.1,0.0,  0.4,0.4,0.1,0.1,  0.2,0.6,0.1,0.1,  0.1,0.2,0.4,0.3,  
               0.4,0.4,0.1,0.1,   0.35,0.5,0.1,0.05,  0.2,0.3,0.3,0.2,  0.15,0.2,0.3,0.35,
               0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.3,0.55,0.1,0.05,  0.1,0.8,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,  
               0.1,0.4,0.4,0.1,  0.1,0.35,0.3,0.25,  0.0,0.1,0.5,0.4,  0.0,0.1,0.7,0.2,
               0.5,0.3,0.2,0.0,  0.3,0.6,0.1,0.0,  0.2,0.2,0.5,0.1,  0.15,0.2,0.4,0.25,  
               0.3,0.3,0.3,0.1,  0.2,0.45,0.35,0.0,  0.2,0.15,0.55,0.1,  0.1,0.3,0.4,0.2,
               0.1,0.15,0.7,0.05,  0.1,0.3,0.5,0.1,  0.0,0.2,0.75,0.05,  0.0,0.2,0.6,0.2,  
               0.2,0.1,0.4,0.3,   0.05,0.2,0.4,0.35,  0.1,0.1,0.7,0.1,  0.05,0.1,0.3,0.55,
               0.5,0.2,0.1,0.2,  0.35,0.25,0.1,0.3,  0.2,0.1,0.4,0.3,  0.2,0.1,0.2,0.5,  
               0.25,0.25,0.1,0.4,  0.1,0.5,0.2,0.2,  0.1,0.3,0.4,0.2,  0.0,0.3,0.2,0.5,
               0.2,0.15,0.35,0.3,  0.1,0.4,0.3,0.2,  0.0,0.2,0.6,0.2,  0.0,0.2,0.1,0.7,  
               0.2,0.0,0.15,0.65,  0.1,0.25,0.2,0.45,  0.0,0.1,0.3,0.6,  0.0,0.05,0.1,0.85), 
             dim = c(4,4,4,4), dimnames = list(O = lv, L = lv, M = lv, N = lv)); cptO

cptP = array(c(0.15, 0.35,0.35,0.15), dim = 4, dimnames = list(P = lv)); cptP

cptQ = array(c(0.05, 0.25,0.45,0.25), dim = 4, dimnames = list(Q = lv)); cptQ

cptR = array(c(0.6,0.3,0.1,0.0,  0.5,0.5,0.0,0.0,  0.1,0.3,0.5,0.1,  0.0,0.0,0.2,0.8), 
             dim = c(4,4), dimnames = list(R = lv, Q = lv)); cptR

cptS = array(c(0.15, 0.25,0.35,0.25), dim = 4, dimnames = list(S = lv)); cptS

cptT = array(c(0.8,0.1,0.1,0.0,  0.3,0.6,0.1,0.0,  0.3,0.2,0.4,0.1,  0.2,0.2,0.4,0.2,
               0.75,0.2,0.05,0.0,  0.3,0.6,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.1,0.8,0.1,  0.0,0.2,0.4,0.4,
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.3,0.6,  0.0,0.0,0.05,0.95),
             dim = c(4,4,4), dimnames = list(T = lv, Q = lv, S = lv)); cptT

cptU = array(c(0.35, 0.25,0.3,0.1), dim = 4, dimnames = list(U = lv)); cptU

apply(cptK,2,sum)
apply(cptO,2,sum)
apply(cptR,2,sum)

Score.coef = matrix(c(2, 2.50, 3, 5.5, 
                      3, 3.50, 4, 7,
                      4.5, 5, 6, 8.75, 
                      7, 7.50, 7.5, 10,
                      7, 7.50, 9, 10.5, 
                      5, 5.50, 6, 9,
                      7.5, 8, 9.5, 10.75, 
                      10, 10.50, 11.5, 14,
                      5, 5.50, 6, 10.5, 
                      6, 6.50, 7, 11,
                      7.5, 8, 9, 12.75, 
                      11, 11.50, 12.5, 15,
                      8, 8.50, 8, 9.5, 
                      9, 10.50, 10, 11,
                      10, 12, 12, 16.75, 
                      10, 14.50, 16.5, 18), nrow = 1, ncol = 64,
                    dimnames = list("(Intercept)", NULL));Score.coef
Score.dist = list(coef = Score.coef, sd = c(0.3, 0.4, 1, 0.31,
                                            0.58, 0.647, 0.2, 0.31,
                                            0.88, 0.87, 1, 0.31,
                                            0.9, 0.95, 0.2, 0.5,
                                            0.5, 0.4, 1, 0.31,
                                            0.68, 0.7, 1.2, 0.31,
                                            1.0, 0.9, 2, 1.31,
                                            0.4, 1.5, 2.2, 1.5,
                                            0.7, 1.4, 2, 1.31,
                                            0.58, 0.647, 2.2, 1.31,
                                            0.88, 0.87, 2, 1.31,
                                            0.9, 0.95, 2.2, 1.5,
                                            1.3, 1.4, 2, 1.31,
                                            1.0, 1.147, 3.2, 1.31,
                                            1.08, 1.27, 1, 1.31,
                                            0.9, 1.25, 1.2, 0.5));Score.dist

net3.1 = model2network("[A][B][C|A][D|B][E|A:B][F][G|N][H|D][I|F][J][K|F:G:H][L][M][N|A][O|L:M:N][P][Q][R|Q][S][T|Q:S][U][Score|G:O:H]")
par(mfrow=c(1,1))
graphviz.plot(net3.1)

cpt = list(A = cptA, B = cptB, C = cptC, D = cptD, E = cptE, F = cptF, G = cptG,
           H = cptH, I = cptI, J = cptJ, K = cptK, L = cptL, M = cptM, N = cptN,
           O = cptO, P = cptP, Q = cptQ, R = cptR, S = cptS, T = cptT, U = cptU, 
           Score=Score.dist)

DAG3.1 = custom.fit(net3.1, cpt, ordinal = c("A", "B", "C", "D", "E", "F", "G", "H",
                                                  "I", "J", "K", "L", "M", "N", "O", "P",
                                                  "Q", "R", "S", "T", "U" ))
################################################################################

#########
# DAG3.2.
lv = c("1", "2", "3", "4")
cptU = array(c(0.9,0.1,0.0,0.0,  0.2,0.8,0.0,0.0,  0.0,0.1,0.8,0.1,  0.0,0.0,0.1,0.9), 
             dim = c(4,4), dimnames = list(U = lv, T = lv) ); cptU

cptT = array(c(0.1, 0.2,0.1,0.6), dim = 4, dimnames = list(T = lv));cptT

cptS = array(c(0.9,0.1,0.0,0.0,  0.2,0.8,0.0,0.0,  0.0,0.1,0.8,0.1,  0.0,0.0,0.1,0.9), 
             dim = c(4,4), dimnames = list(S = lv, O = lv) ); cptS

cptR = array(c(0.7,0.2,0.1,0.0,  0.4,0.5,0.1,0.0,  0.1,0.3,0.5,0.1,  0.0,0.0,0.4,0.6), 
             dim = c(4,4), dimnames = list(R = lv, P = lv)); cptR

cptQ = array(c(0.7,0.2,0.1,0.0,  0.65,0.25,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.5,0.3,0.2,0.0,  0.75,0.15,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.2,0.1,  0.1,0.35,0.35,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.3,0.5,  
               0.1,0.4,0.4,0.1,  0.1,0.0,0.75,0.15,  0.0,0.1,0.5,0.4,  0.0,0.0,0.3,0.7), 
             dim = c(4, 4, 4),
             dimnames = list(Q = lv, M = lv, N = lv) ); cptQ

cptP = array(c(0.1, 0.8,0.05,0.05), dim = 4, dimnames = list(P = lv)); cptP

cptO = array(c(0.9,0.05,0.05,0.0,  0.8,0.1,0.1,0.0,  0.2,0.3,0.4,0.1,  0.0,0.0,0.05,0.95), 
             dim = c(4,4), dimnames = list(O = lv, C = lv)); cptO

cptN = array(c(0.9,0.1,0.0,0.0,  0.8,0.1,0.1,0.0,  0.1,0.5,0.3,0.1,  0.0,0.0,0.1,0.9), 
             dim = c(4,4), dimnames = list(N = lv, C = lv)); cptN

cptM = array(c(0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,
               0.65,0.3,0.05,0.0,  0.8,0.1,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.5,0.4,  0.0,0.0,0.1,0.9),
             dim = c(4,4,4), dimnames = list(M = lv, J = lv, L = lv)); cptM

cptL = array(c(0.25, 0.35,0.15,0.25), dim = 4, dimnames = list(L = lv)); cptL

cptK = array(c(0.9,0.1,0.0,0.0,  0.8,0.1,0.1,0.0,  0.6,0.3,0.05,0.05,  0.4,0.3,0.2,0.1,  
               0.85,0.1,0.05,0.0,  0.7,0.15,0.15,0.0,  0.4,0.4,0.15,0.05,  0.3,0.3,0.2,0.2,
               0.45,0.45,0.1,0.0,  0.4,0.4,0.1,0.1,  0.2,0.6,0.1,0.1,  0.1,0.2,0.4,0.3,  
               0.4,0.4,0.1,0.1,   0.35,0.5,0.1,0.05,  0.2,0.3,0.3,0.2,  0.15,0.2,0.3,0.35,
               0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.35,0.5,0.1,0.05,  0.1,0.8,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,  
               0.1,0.4,0.4,0.1,  0.1,0.35,0.3,0.25,  0.0,0.1,0.5,0.4,  0.0,0.1,0.7,0.2,
               0.5,0.3,0.2,0.0,  0.3,0.6,0.1,0.0,  0.2,0.2,0.5,0.1,  0.15,0.2,0.4,0.25,  
               0.3,0.4,0.2,0.1,  0.2,0.55,0.25,0.0,  0.2,0.15,0.55,0.1,  0.1,0.3,0.4,0.2,
               0.15,0.15,0.6,0.1,  0.1,0.3,0.5,0.1,  0.0,0.2,0.75,0.05,  0.0,0.2,0.6,0.2,  
               0.2,0.1,0.4,0.3,   0.05,0.2,0.4,0.35,  0.1,0.1,0.7,0.1,  0.05,0.1,0.3,0.55,
               0.5,0.2,0.1,0.2,  0.3,0.3,0.1,0.3,  0.2,0.1,0.4,0.3,  0.2,0.1,0.2,0.5,  
               0.25,0.25,0.1,0.4,  0.1,0.5,0.2,0.2,  0.1,0.3,0.4,0.2,  0.0,0.3,0.2,0.5,
               0.2,0.15,0.35,0.3,  0.1,0.4,0.3,0.2,  0.0,0.2,0.6,0.2,  0.0,0.2,0.2,0.6,  
               0.2,0.0,0.15,0.65,  0.1,0.25,0.2,0.45,  0.0,0.1,0.3,0.6,  0.0,0.1,0.1,0.8), 
             dim = c(4,4,4,4), dimnames = list(K = lv, H = lv, G = lv, I = lv)); cptK

cptJ = array(c(0.25, 0.45,0.15,0.15), dim = 4, dimnames = list(J = lv)); cptJ

cptI = array(c(0.15, 0.25,0.35,0.25), dim = 4, dimnames = list(I = lv)); cptI

cptH = array(c(0.8,0.2,0.0,0.0,  0.3,0.7,0.0,0.0,  0.1,0.3,0.5,0.1,  0.0,0.0,0.1,0.9), 
             dim = c(4,4), dimnames = list(H = lv, D = lv)); cptH

cptG = array(c(0.95,0.05,0.0,0.0,  0.8,0.1,0.1,0.0,  0.6,0.3,0.05,0.05,  0.4,0.3,0.2,0.1,  
               0.9,0.1,0.0,0.0,  0.7,0.15,0.15,0.0,  0.4,0.4,0.15,0.05,  0.3,0.3,0.2,0.2,
               0.55,0.35,0.1,0.0,  0.4,0.4,0.1,0.1,  0.2,0.6,0.1,0.1,  0.1,0.2,0.4,0.3,  
               0.4,0.4,0.1,0.1,   0.35,0.5,0.1,0.05,  0.2,0.3,0.3,0.2,  0.15,0.2,0.3,0.35,
               0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.3,0.55,0.1,0.05,  0.1,0.8,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,  
               0.1,0.4,0.4,0.1,  0.1,0.35,0.3,0.25,  0.0,0.1,0.5,0.4,  0.0,0.1,0.7,0.2,
               0.5,0.3,0.2,0.0,  0.3,0.6,0.1,0.0,  0.2,0.2,0.5,0.1,  0.15,0.2,0.4,0.25,  
               0.3,0.3,0.3,0.1,  0.2,0.45,0.35,0.0,  0.2,0.15,0.55,0.1,  0.1,0.3,0.4,0.2,
               0.1,0.15,0.7,0.05,  0.1,0.3,0.5,0.1,  0.0,0.2,0.75,0.05,  0.0,0.2,0.6,0.2,  
               0.2,0.1,0.4,0.3,   0.05,0.2,0.4,0.35,  0.1,0.1,0.7,0.1,  0.05,0.1,0.3,0.55,
               0.5,0.2,0.1,0.2,  0.35,0.25,0.1,0.3,  0.2,0.1,0.4,0.3,  0.2,0.1,0.2,0.5,  
               0.25,0.25,0.1,0.4,  0.1,0.5,0.2,0.2,  0.1,0.3,0.4,0.2,  0.0,0.3,0.2,0.5,
               0.2,0.15,0.35,0.3,  0.1,0.4,0.3,0.2,  0.0,0.2,0.6,0.2,  0.0,0.2,0.1,0.7,  
               0.2,0.0,0.15,0.65,  0.1,0.25,0.2,0.45,  0.0,0.1,0.3,0.6,  0.0,0.05,0.1,0.85), 
             dim = c(4,4,4,4), dimnames = list(G = lv, D = lv, E = lv, F = lv)); cptG

cptF = array(c(0.15, 0.35,0.35,0.15), dim = 4, dimnames = list(F = lv)); cptF

cptE = array(c(0.05, 0.25,0.45,0.25), dim = 4, dimnames = list(E = lv)); cptE

cptD = array(c(0.6,0.3,0.1,0.0,  0.5,0.5,0.0,0.0,  0.1,0.3,0.5,0.1,  0.0,0.0,0.2,0.8), 
             dim = c(4,4), dimnames = list(D = lv, C = lv)); cptR

cptC = array(c(0.8,0.1,0.1,0.0,  0.3,0.6,0.1,0.0,  0.3,0.2,0.4,0.1,  0.2,0.2,0.4,0.2,
               0.75,0.2,0.05,0.0,  0.3,0.6,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.1,0.8,0.1,  0.0,0.2,0.4,0.4,
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.3,0.6,  0.0,0.0,0.05,0.95),
             dim = c(4,4,4), dimnames = list(C = lv, A = lv, B = lv)); cptC

cptB = array(c(0.15, 0.25,0.35,0.25), dim = 4, dimnames = list(B = lv)); cptB

cptA = array(c(0.35, 0.25,0.3,0.1), dim = 4, dimnames = list(A = lv)); cptA

apply(cptK,2,sum)
apply(cptO,2,sum)
apply(cptR,2,sum)

Score.coef = matrix(c(2, 2.50, 3, 5.5, 
                      3, 3.50, 4, 7,
                      4.5, 5, 6, 8.75, 
                      7, 7.50, 7.5, 10,
                      7, 7.50, 9, 10.5, 
                      5, 5.50, 6, 9,
                      7.5, 8, 9.5, 10.75, 
                      10, 10.50, 11.5, 14,
                      5, 5.50, 6, 10.5, 
                      6, 6.50, 7, 11,
                      7.5, 8, 9, 12.75, 
                      11, 11.50, 12.5, 15,
                      8, 8.50, 8, 9.5, 
                      9, 10.50, 10, 11,
                      10, 12, 12, 16.75, 
                      10, 14.50, 16.5, 18), nrow = 1, ncol = 64,
                    dimnames = list("(Intercept)", NULL));Score.coef
Score.dist = list(coef = Score.coef, sd = c(0.3, 0.4, 1, 0.31,
                                            0.58, 0.647, 0.2, 0.31,
                                            0.88, 0.87, 1, 0.31,
                                            0.9, 0.95, 0.2, 0.5,
                                            0.5, 0.4, 1, 0.31,
                                            0.68, 0.7, 1.2, 0.31,
                                            1.0, 0.9, 2, 1.31,
                                            0.4, 1.5, 2.2, 1.5,
                                            0.7, 1.4, 2, 1.31,
                                            0.58, 0.647, 2.2, 1.31,
                                            0.88, 0.87, 2, 1.31,
                                            0.9, 0.95, 2.2, 1.5,
                                            1.3, 1.4, 2, 1.31,
                                            1.0, 1.147, 3.2, 1.31,
                                            1.08, 1.27, 1, 1.31,
                                            0.9, 1.25, 1.2, 0.5));Score.dist

net3.2 = model2network("[A][B][C|A:B][D|C][E][F][G|D:E:F][H|D][I][J][K|H:G:I][L][M|J:L][N|C][O|C][P][Q|M:N][R|P][S|O][T][U|T][Score|S:Q:I]")
par(mfrow=c(1,1))
graphviz.plot(net3.2)

cpt = list(A = cptA, B = cptB, C = cptC, D = cptD, E = cptE, F = cptF, G = cptG,
           H = cptH, I = cptI, J = cptJ, K = cptK, L = cptL, M = cptM, N = cptN,
           O = cptO, P = cptP, Q = cptQ, R = cptR, S = cptS, T = cptT, U = cptU, 
           Score=Score.dist)

DAG3.2 = custom.fit(net3.2, cpt, ordinal = c("A", "B", "C", "D", "E", "F", "G", "H",
                                                    "I", "J", "K", "L", "M", "N", "O", "P",
                                                    "Q", "R", "S", "T", "U" ))
################################################################################

#########
# DAG4.1.
lv = c("1", "2", "3", "4")
cptA = array(c(0.5, 0.2,0.1,0.2), dim = 4, dimnames = list(A = lv));cptA

cptB = array(c(0.1, 0.2,0.1,0.6), dim = 4, dimnames = list(B = lv));cptB

cptC = array(c(0.9,0.1,0.0,0.0,  0.2,0.8,0.0,0.0,  0.0,0.1,0.8,0.1,  0.0,0.0,0.1,0.9), 
             dim = c(4,4), dimnames = list(C = lv, A = lv) ); cptC

cptD = array(c(0.7,0.2,0.1,0.0,  0.65,0.25,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.5,0.3,0.2,0.0,  0.75,0.15,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.2,0.1,  0.1,0.35,0.35,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.3,0.5,  
               0.1,0.4,0.4,0.1,  0.1,0.0,0.75,0.15,  0.0,0.1,0.5,0.4,  0.0,0.0,0.3,0.7), 
             dim = c(4, 4, 4),
             dimnames = list(D = lv, A = lv, B = lv) ); cptD

cptE = array(c(0.7,0.2,0.1,0.0,  0.4,0.5,0.1,0.0,  0.1,0.3,0.5,0.1,  0.0,0.0,0.4,0.6), 
             dim = c(4,4), dimnames = list(E = lv, B = lv)); cptE

cptF = array(c(0.1, 0.6,0.25,0.05), dim = 4, dimnames = list(F = lv)); cptF

cptG = array(c(0.9,0.05,0.05,0.0,  0.8,0.1,0.1,0.0,  0.2,0.3,0.4,0.1,  0.0,0.0,0.05,0.95), 
             dim = c(4,4), dimnames = list(G = lv, N = lv)); cptG

cptH = array(c(0.9,0.1,0.0,0.0,  0.8,0.1,0.1,0.0,  0.1,0.5,0.3,0.1,  0.0,0.0,0.1,0.9), 
             dim = c(4,4), dimnames = list(H = lv, D = lv)); cptH

cptI = array(c(0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,
               0.65,0.3,0.05,0.0,  0.8,0.1,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.5,0.4,  0.0,0.0,0.1,0.9),
             dim = c(4,4,4), dimnames = list(I = lv, F = lv, H = lv)); cptI

cptJ = array(c(0.25, 0.35,0.15,0.25), dim = 4, dimnames = list(J = lv)); cptJ

cptK = array(c(0.9,0.1,0.0,0.0,  0.8,0.1,0.1,0.0,  0.6,0.3,0.05,0.05,  0.4,0.3,0.2,0.1,  
               0.85,0.1,0.05,0.0,  0.7,0.15,0.15,0.0,  0.4,0.4,0.15,0.05,  0.3,0.3,0.2,0.2,
               0.45,0.45,0.1,0.0,  0.4,0.4,0.1,0.1,  0.2,0.6,0.1,0.1,  0.1,0.2,0.4,0.3,  
               0.4,0.4,0.1,0.1,   0.35,0.5,0.1,0.05,  0.2,0.3,0.3,0.2,  0.15,0.2,0.3,0.35,
               0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.35,0.5,0.1,0.05,  0.1,0.8,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,  
               0.1,0.4,0.4,0.1,  0.1,0.35,0.3,0.25,  0.0,0.1,0.5,0.4,  0.0,0.1,0.7,0.2,
               0.5,0.3,0.2,0.0,  0.3,0.6,0.1,0.0,  0.2,0.2,0.5,0.1,  0.15,0.2,0.4,0.25,  
               0.3,0.4,0.2,0.1,  0.2,0.55,0.25,0.0,  0.2,0.15,0.55,0.1,  0.1,0.3,0.4,0.2,
               0.15,0.15,0.6,0.1,  0.1,0.3,0.5,0.1,  0.0,0.2,0.75,0.05,  0.0,0.2,0.6,0.2,  
               0.2,0.1,0.4,0.3,   0.05,0.2,0.4,0.35,  0.1,0.1,0.7,0.1,  0.05,0.1,0.3,0.55,
               0.5,0.2,0.1,0.2,  0.3,0.3,0.1,0.3,  0.2,0.1,0.4,0.3,  0.2,0.1,0.2,0.5,  
               0.25,0.25,0.1,0.4,  0.1,0.5,0.2,0.2,  0.1,0.3,0.4,0.2,  0.0,0.3,0.2,0.5,
               0.2,0.15,0.35,0.3,  0.1,0.4,0.3,0.2,  0.0,0.2,0.6,0.2,  0.0,0.2,0.2,0.6,  
               0.2,0.0,0.15,0.65,  0.1,0.25,0.2,0.45,  0.0,0.1,0.3,0.6,  0.0,0.1,0.1,0.8), 
             dim = c(4,4,4,4), dimnames = list(K = lv, F = lv, G = lv, H = lv)); cptK

cptL = array(c(0.25, 0.45,0.15,0.15), dim = 4, dimnames = list(L = lv)); cptL

cptM = array(c(0.15, 0.25,0.35,0.25), dim = 4, dimnames = list(M = lv)); cptM

cptN = array(c(0.1, 0.2,0.5,0.2), dim = 4, dimnames = list(N = lv)); cptN

cptO = array(c(0.95,0.05,0.0,0.0,  0.8,0.1,0.1,0.0,  0.6,0.3,0.05,0.05,  0.4,0.3,0.2,0.1,  
               0.9,0.1,0.0,0.0,  0.7,0.15,0.15,0.0,  0.4,0.4,0.15,0.05,  0.3,0.3,0.2,0.2,
               0.55,0.35,0.1,0.0,  0.4,0.4,0.1,0.1,  0.2,0.6,0.1,0.1,  0.1,0.2,0.4,0.3,  
               0.4,0.4,0.1,0.1,   0.35,0.5,0.1,0.05,  0.2,0.3,0.3,0.2,  0.15,0.2,0.3,0.35,
               0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.3,0.55,0.1,0.05,  0.1,0.8,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,  
               0.1,0.4,0.4,0.1,  0.1,0.35,0.3,0.25,  0.0,0.1,0.5,0.4,  0.0,0.1,0.7,0.2,
               0.5,0.3,0.2,0.0,  0.3,0.6,0.1,0.0,  0.2,0.2,0.5,0.1,  0.15,0.2,0.4,0.25,  
               0.3,0.3,0.3,0.1,  0.2,0.45,0.35,0.0,  0.2,0.15,0.55,0.1,  0.1,0.3,0.4,0.2,
               0.1,0.15,0.7,0.05,  0.1,0.3,0.5,0.1,  0.0,0.2,0.75,0.05,  0.0,0.2,0.6,0.2,  
               0.2,0.1,0.4,0.3,   0.05,0.2,0.4,0.35,  0.1,0.1,0.7,0.1,  0.05,0.1,0.3,0.55,
               0.5,0.2,0.1,0.2,  0.35,0.25,0.1,0.3,  0.2,0.1,0.4,0.3,  0.2,0.1,0.2,0.5,  
               0.25,0.25,0.1,0.4,  0.1,0.5,0.2,0.2,  0.1,0.3,0.4,0.2,  0.0,0.3,0.2,0.5,
               0.2,0.15,0.35,0.3,  0.1,0.4,0.3,0.2,  0.0,0.2,0.6,0.2,  0.0,0.2,0.1,0.7,  
               0.2,0.0,0.15,0.65,  0.1,0.25,0.2,0.45,  0.0,0.1,0.3,0.6,  0.0,0.05,0.1,0.85), 
             dim = c(4,4,4,4), dimnames = list(O = lv, L = lv, M = lv, N = lv)); cptO

cptP = array(c(0.15, 0.35,0.35,0.15), dim = 4, dimnames = list(P = lv)); cptP

cptQ = array(c(0.05, 0.25,0.45,0.25), dim = 4, dimnames = list(Q = lv)); cptQ

cptR = array(c(0.6,0.3,0.1,0.0,  0.5,0.5,0.0,0.0,  0.1,0.3,0.5,0.1,  0.0,0.0,0.2,0.8), 
             dim = c(4,4), dimnames = list(R = lv, Q = lv)); cptR

cptS = array(c(0.55, 0.25,0.15,0.05), dim = 4, dimnames = list(S = lv)); cptS

cptT = array(c(0.8,0.1,0.1,0.0,  0.3,0.6,0.1,0.0,  0.3,0.2,0.4,0.1,  0.2,0.2,0.4,0.2,
               0.75,0.2,0.05,0.0,  0.3,0.6,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.1,0.8,0.1,  0.0,0.2,0.4,0.4,
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.3,0.6,  0.0,0.0,0.05,0.95),
             dim = c(4,4,4), dimnames = list(T = lv, Q = lv, S = lv)); cptT

cptU = array(c(0.35, 0.25,0.3,0.1), dim = 4, dimnames = list(U = lv)); cptU

cptV = array(c(0.95,0.05,0.0,0.0,  0.8,0.1,0.1,0.0,  0.6,0.3,0.05,0.05,  0.4,0.3,0.2,0.1,  
               0.9,0.1,0.0,0.0,  0.7,0.15,0.15,0.0,  0.4,0.4,0.15,0.05,  0.3,0.3,0.2,0.2,
               0.55,0.35,0.1,0.0,  0.4,0.4,0.1,0.1,  0.2,0.6,0.1,0.1,  0.1,0.2,0.4,0.3,  
               0.4,0.4,0.1,0.1,   0.35,0.5,0.1,0.05,  0.2,0.3,0.3,0.2,  0.15,0.2,0.3,0.35,
               0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.3,0.55,0.1,0.05,  0.1,0.8,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,  
               0.1,0.4,0.4,0.1,  0.1,0.35,0.3,0.25,  0.0,0.1,0.5,0.4,  0.0,0.1,0.7,0.2,
               0.5,0.3,0.2,0.0,  0.3,0.6,0.1,0.0,  0.2,0.2,0.5,0.1,  0.15,0.2,0.4,0.25,  
               0.3,0.3,0.3,0.1,  0.2,0.45,0.35,0.0,  0.2,0.15,0.55,0.1,  0.1,0.3,0.4,0.2,
               0.1,0.15,0.7,0.05,  0.1,0.3,0.5,0.1,  0.0,0.2,0.75,0.05,  0.0,0.2,0.6,0.2,  
               0.2,0.1,0.4,0.3,   0.05,0.2,0.4,0.35,  0.1,0.1,0.7,0.1,  0.05,0.1,0.3,0.55,
               0.5,0.2,0.1,0.2,  0.35,0.25,0.1,0.3,  0.2,0.1,0.4,0.3,  0.2,0.1,0.2,0.5,  
               0.25,0.25,0.1,0.4,  0.1,0.5,0.2,0.2,  0.1,0.3,0.4,0.2,  0.0,0.3,0.2,0.5,
               0.2,0.15,0.35,0.3,  0.1,0.4,0.3,0.2,  0.0,0.2,0.6,0.2,  0.0,0.2,0.1,0.7,  
               0.2,0.0,0.15,0.65,  0.1,0.25,0.2,0.45,  0.0,0.1,0.3,0.6,  0.0,0.05,0.1,0.85), 
             dim = c(4,4,4,4), dimnames = list(V = lv, T = lv, X = lv, Y = lv)); cptV

cptW = array(c(0.45, 0.25,0.1,0.2), dim = 4, dimnames = list(W = lv)); cptW

cptX = array(c(0.8,0.1,0.1,0.0,  0.2,0.7,0.1,0.0,  0.1,0.3,0.5,0.1,  0.0,0.0,0.2,0.8), 
             dim = c(4,4), dimnames = list(X = lv, U = lv)); cptX

cptY = array(c(0.55, 0.25,0.15,0.05), dim = 4, dimnames = list(Y = lv)); cptY

cptZ = array(c(0.15, 0.25,0.25,0.35), dim = 4, dimnames = list(Z = lv)); cptZ


apply(cptK,2,sum)
apply(cptO,2,sum)
apply(cptR,2,sum)

Score.coef = matrix(c(2, 2.50, 3, 5.5, 
                      3, 3.50, 4, 7,
                      4.5, 5, 6, 8.75, 
                      7, 7.50, 7.5, 10,
                      7, 7.50, 9, 10.5, 
                      5, 5.50, 6, 9,
                      7.5, 8, 9.5, 10.75, 
                      10, 10.50, 11.5, 14,
                      5, 5.50, 6, 10.5, 
                      6, 6.50, 7, 11,
                      7.5, 8, 9, 12.75, 
                      11, 11.50, 12.5, 15,
                      8, 8.50, 8, 9.5, 
                      9, 10.50, 10, 11,
                      10, 12, 12, 16.75, 
                      10, 14.50, 16.5, 18), nrow = 1, ncol = 64,
                    dimnames = list("(Intercept)", NULL));Score.coef
Score.dist = list(coef = Score.coef, sd = c(0.3, 0.4, 1, 0.31,
                                            0.58, 0.647, 0.2, 0.31,
                                            0.88, 0.87, 1, 0.31,
                                            0.9, 0.95, 0.2, 0.5,
                                            0.5, 0.4, 1, 0.31,
                                            0.68, 0.7, 1.2, 0.31,
                                            1.0, 0.9, 2, 1.31,
                                            0.4, 1.5, 2.2, 1.5,
                                            0.7, 1.4, 2, 1.31,
                                            0.58, 0.647, 2.2, 1.31,
                                            0.88, 0.87, 2, 1.31,
                                            0.9, 0.95, 2.2, 1.5,
                                            1.3, 1.4, 2, 1.31,
                                            1.0, 1.147, 3.2, 1.31,
                                            1.08, 1.27, 1, 1.31,
                                            0.9, 1.25, 1.2, 0.5));Score.dist

net4.1 = model2network("[A][B][C|A][D|A:B][E|B][F][G|N][H|D][I|F:H][J][K|F:G:H][L][M][N][O|L:M:N][P][Q][R|Q][S][T|Q:S][U][V|T:X:Y][W][X|U][Y][Z][Score|E:R:T]")
par(mfrow=c(1,1))
graphviz.plot(net4.1)

cpt = list(A = cptA, B = cptB, C = cptC, D = cptD, E = cptE, F = cptF, G = cptG,
           H = cptH, I = cptI, J = cptJ, K = cptK, L = cptL, M = cptM, N = cptN,
           O = cptO, P = cptP, Q = cptQ, R = cptR, S = cptS, T = cptT, U = cptU,
           V = cptV, W = cptW, X = cptX, Y = cptY, Z = cptZ, Score=Score.dist)

DAG4.1 = custom.fit(net4.1, cpt, ordinal = c("A", "B", "C", "D", "E", "F", "G", "H",
                                                  "I", "J", "K", "L", "M", "N", "O", "P",
                                                  "Q", "R", "S", "T", "U", "V", "W", "X", 
                                                  "Y", "Z" ))
################################################################################

#########
# DAG4.2.
lv = c("1", "2", "3", "4")
cptA = array(c(0.5, 0.2,0.1,0.2), dim = 4, dimnames = list(A = lv));cptA

cptB = array(c(0.1, 0.2,0.1,0.6), dim = 4, dimnames = list(B = lv));cptB

cptC = array(c(0.8,0.1,0.1,0.0,  0.3,0.6,0.1,0.0,  0.3,0.2,0.4,0.1,  0.2,0.2,0.4,0.2,
               0.75,0.2,0.05,0.0,  0.3,0.6,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.1,0.8,0.1,  0.0,0.2,0.4,0.4,
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.3,0.6,  0.0,0.0,0.05,0.95),
             dim = c(4,4,4), dimnames = list(C = lv, A = lv, B = lv)); cptC

cptD = array(c(0.9,0.1,0.0,0.0,  0.5,0.4,0.1,0.0,  0.3,0.2,0.4,0.1,  0.2,0.2,0.4,0.2,
               0.85,0.1,0.05,0.0,  0.5,0.4,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.1,0.8,0.1,  0.0,0.2,0.4,0.4,
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.3,0.6,  0.0,0.0,0.05,0.95),
             dim = c(4,4,4), dimnames = list(D = lv, A = lv, B = lv)); cptD

cptE = array(c(0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,
               0.65,0.3,0.05,0.0,  0.8,0.1,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.5,0.4,  0.0,0.0,0.1,0.9),
             dim = c(4,4,4), dimnames = list(E = lv, C = lv, D = lv)); cptE

cptF = array(c(0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,
               0.65,0.3,0.05,0.0,  0.8,0.1,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.5,0.4,  0.0,0.0,0.1,0.9),
             dim = c(4,4,4), dimnames = list(F = lv, A = lv, D = lv)); cptE

cptG = array(c(0.9,0.05,0.05,0.0,  0.8,0.1,0.1,0.0,  0.2,0.3,0.4,0.1,  0.0,0.0,0.05,0.95), 
             dim = c(4,4), dimnames = list(G = lv, F = lv)); cptG

cptH = array(c(0.9,0.1,0.0,0.0,  0.8,0.1,0.1,0.0,  0.1,0.5,0.3,0.1,  0.0,0.0,0.1,0.9), 
             dim = c(4,4), dimnames = list(H = lv, F = lv)); cptH

cptI = array(c(0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,
               0.65,0.3,0.05,0.0,  0.8,0.1,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.5,0.4,  0.0,0.0,0.1,0.9),
             dim = c(4,4,4), dimnames = list(I = lv, G = lv, H = lv)); cptI

cptJ = array(c(0.25, 0.35,0.15,0.25), dim = 4, dimnames = list(J = lv)); cptJ

cptK = array(c(0.9,0.1,0.0,0.0,  0.3,0.6,0.1,0.0,  0.1,0.05,0.75,0.1,  0.0,0.0,0.1,0.9),
             dim = c(4,4), dimnames = list(K = lv, H = lv)); cptK

cptL = array(c(0.25, 0.45,0.15,0.15), dim = 4, dimnames = list(L = lv)); cptL

cptM = array(c(0.15, 0.25,0.35,0.25), dim = 4, dimnames = list(M = lv)); cptM

cptN = array(c(0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,
               0.65,0.3,0.05,0.0,  0.8,0.1,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.5,0.4,  0.0,0.0,0.1,0.9),
             dim = c(4,4,4), dimnames = list(N = lv, L = lv, M = lv)); cptN

cptO = array(c(0.8,0.2,0.0,0.0,  0.3,0.7,0.0,0.0,  0.1,0.3,0.5,0.1,  0.0,0.0,0.1,0.9),
             dim = c(4,4), dimnames = list(O = lv, L = lv)); cptN

cptP = array(c(0.15, 0.35,0.35,0.15), dim = 4, dimnames = list(P = lv)); cptP

cptQ = array(c(0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,
               0.65,0.3,0.05,0.0,  0.8,0.1,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.5,0.4,  0.0,0.0,0.1,0.9),
             dim = c(4,4,4), dimnames = list(Q = lv, O = lv, P = lv)); cptQ

cptR = array(c(0.6,0.3,0.1,0.0,  0.5,0.5,0.0,0.0,  0.1,0.3,0.5,0.1,  0.0,0.0,0.2,0.8), 
             dim = c(4,4), dimnames = list(R = lv, Q = lv)); cptR

cptS = array(c(0.55, 0.25,0.15,0.05), dim = 4, dimnames = list(S = lv)); cptS

cptT = array(c(0.8,0.1,0.1,0.0,  0.3,0.6,0.1,0.0,  0.3,0.2,0.4,0.1,  0.2,0.2,0.4,0.2,
               0.75,0.2,0.05,0.0,  0.3,0.6,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.1,0.8,0.1,  0.0,0.2,0.4,0.4,
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.3,0.6,  0.0,0.0,0.05,0.95),
             dim = c(4,4,4), dimnames = list(T = lv, R = lv, S = lv)); cptT

cptU = array(c(0.35, 0.25,0.3,0.1), dim = 4, dimnames = list(U = lv)); cptU

cptV = array(c(0.5,0.4,0.1,0.0,  0.3,0.6,0.1,0.0,  0.1,0.2,0.6,0.1,  0.0,0.1,0.1,0.8),
             dim = c(4,4), dimnames = list(V = lv, T = lv)); cptV

cptW = array(c(0.45, 0.25,0.1,0.2), dim = 4, dimnames = list(W = lv)); cptW

cptX = array(c(0.8,0.1,0.1,0.0,  0.2,0.7,0.1,0.0,  0.1,0.3,0.5,0.1,  0.0,0.0,0.2,0.8), 
             dim = c(4,4), dimnames = list(X = lv, S = lv)); cptX

cptY = array(c(0.55, 0.25,0.15,0.05), dim = 4, dimnames = list(Y = lv)); cptY

cptZ = array(c(0.8,0.1,0.1,0.0,  0.2,0.7,0.1,0.0,  0.1,0.3,0.5,0.1,  0.0,0.0,0.2,0.8), 
             dim = c(4,4), dimnames = list(Z = lv, Y = lv)); cptZ

apply(cptK,2,sum)
apply(cptO,2,sum)
apply(cptR,2,sum)

Score.coef = matrix(c(2, 2.50, 3, 6.5, 
                      3, 3.50, 4, 7,
                      4.5, 5, 6, 9.75, 
                      5, 5.50, 6.5, 12), nrow = 1, ncol = 16,
                    dimnames = list("(Intercept)", NULL));Score.coef
Score.dist = list(coef = Score.coef, sd = c(0.3, 0.4, 1, 0.31,
                                            0.58, 0.647, 0.2, 0.41,
                                            0.88, 0.87, 1, 0.31,
                                            0.9, 0.95, 0.6, 0.7));Score.dist

net4.2 = model2network("[A][B][C|A:B][D|A:B][E|C:D][F|A:D][G|F][H|F][I|G:H][J][K|H][L][M][N|L:M][O|L][P][Q|O:P][R|Q][S][T|R:S][U][V|T][W][X|S][Y][Z|Y][Score|I:K]")
par(mfrow=c(1,1))
graphviz.plot(net4.2)

cpt = list(A = cptA, B = cptB, C = cptC, D = cptD, E = cptE, F = cptF, G = cptG,
           H = cptH, I = cptI, J = cptJ, K = cptK, L = cptL, M = cptM, N = cptN,
           O = cptO, P = cptP, Q = cptQ, R = cptR, S = cptS, T = cptT, U = cptU,
           V = cptV, W = cptW, X = cptX, Y = cptY, Z = cptZ, Score=Score.dist)

DAG4.2 = custom.fit(net4.2, cpt, ordinal = c("A", "B", "C", "D", "E", "F", "G", "H",
                                                    "I", "J", "K", "L", "M", "N", "O", "P",
                                                    "Q", "R", "S", "T", "U", "V", "W", "X", 
                                                    "Y", "Z" ))
################################################################################


# The simulation study involved randomly generating samples (patients) based on 
# each one of the two DAGs considered each time (generally denoted as DAG1 and DAG2),
# using the "rbn" function with the R package bnlearn.
# The number  represented the sample size in each case, namely the number of 
# simulated patients (completed questionnaires) and received the values of 
# 100, 500, 1000 and 5000.

# Example.
k<-500
net1.1;net1.2;net2.1;net2.2;net3.1;net3.2;net4.1;net4.2
sample1 <- rbn(DAG1.1, k+1);sample1
sample2 <- rbn(DAG1.2, k+1);sample2
sample1 <- rbn(DAG2.1, k+1);sample1
sample2 <- rbn(DAG2.2, k+1);sample2
sample1 <- rbn(DAG3.1, k+1);sample1
sample2 <- rbn(DAG3.2, k+1);sample2
sample1 <- rbn(DAG4.1, k+1);sample1
sample2 <- rbn(DAG4.2, k+1);sample2
DAG1 = pc.stable(sample1[1:k,]);DAG1
DAG2 = pc.stable(sample2[1:k,]);DAG2








